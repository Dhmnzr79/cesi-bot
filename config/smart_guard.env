# Умный guard с обходами - рекомендуемые настройки
RESPONSE_MODE=legacy
ENABLE_GUARD=true
ENABLE_NORMALIZATION=true
ENABLE_FOLLOWUPS=true
ENABLE_SMART_FOLLOWUPS=true
ENABLE_EMPATHY=true
ENABLE_ENHANCED_EMPATHY=true
POSTPROCESS_STRIP_TEXTUAL_CTA=true
SUPPRESS_EMPATHY_CLOSER_WHEN_CTA=true

# Более мягкий порог для умного guard
GUARD_THRESHOLD=0.15

# Настройки Flask
FLASK_ENV=production
FLASK_DEBUG=false

# --- RAG_MODE: переключатель режимов ---
RAG_MODE=HYBRID_TIGHT

# --- Precise-Simple (один ретривер) ---
EMB_TOPK=4
RERANK_ENABLE=false

# --- Hybrid-Tight ---
HYBRID_ENABLE=true
HYBRID_W_EMB=0.60
HYBRID_W_BM25=0.40
HYBRID_TOPK_EMB=6
HYBRID_TOPK_BM25=6
HYBRID_K=8
FUSION_METHOD=RRF
RRF_K=60
RERANK_ENABLE=true
RERANK_TOP_R=3

# --- Guard ---
GUARD_ENABLE=true
GUARD_DYNAMIC=true
GUARD_THRESHOLD=0.60
GUARD_SOFT_MIN=0.56
GUARD_MARGIN=0.07

# --- MQ (только при длинных запросах) ---
MQ_ENABLE_CONDITIONAL=true
MQ_MIN_WORDS=5
MQ_MAX_VARIANTS=2
MQ_MAX_CANDIDATES=8
MQ_EXCLUDE_PATTERNS="больно|страшно|адрес|как добраться"

# --- Прочее ---
LEN_PENALTY=0.03

# OpenAI (если доступен)
# OPENAI_API_KEY=your_key_here

# Гибридный ретривер
HYBRID_W_EMB=0.55
HYBRID_W_BM25=0.45
HYBRID_TOPK_EMB=6
HYBRID_TOPK_BM25=8
HYBRID_K=3
GUARD_THRESHOLD=0.65
BOOST_CONTACTS=0.10
BOOST_PRICES=0.08
LEN_PENALTY=0.05
HYBRID_ENABLE=true
GUARD_ENABLE=true






